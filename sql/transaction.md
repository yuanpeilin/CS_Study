# 目录
- [事务](#事务)
- [ROLLBACK](#rollback)
- [COMMIT](#commit)
- [保留点](#保留点)



<!-- = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = -->
<!-- = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = -->



# 事务
事务处理(transaction processing)可以用来维护数据库的完整性, 它保证成批的MySQL操作要么完全执行, 要么完全不执行  



<!-- = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = -->
<!-- = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = -->



# ROLLBACK
ROLLBACK语句回退到START TRANSACTION之后的所有语句  
```sql
SELECT * FROM ordertotals;
START TRANSACTION;
DELETE FROM ordertotals;
SELECT * FROM ordertotals;
ROLLBACK;
```



<!-- = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = -->
<!-- = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = -->



# COMMIT
如果第一条DELETE起作用, 但第二条失败, 则所有DELETE不会提交  
```sql
START TRANSACTION;
DELETE FROM orderitems WHERE order_num = 20010;
DELETE FROM orders WHERE order_num = 20010;
COMMIT;
```



<!-- = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = -->
<!-- = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = -->



# 保留点
为了支持回退部分事务处理, 必须能在事务处理块中合适的位置放置占位符. 这样, 如果需要回退, 可以回退到某个占位符  
这些占位符称为 **保留点**  
保留点在事务处理完成(执行一条ROLLBACK或COMMIT)后自动释放  
创建占位符使用SAVEPOINT语句  
```sql
SAVEPOINT delete1;
```
  
回退到指定的保留点:  
```sql
ROLLBACK TO delete1;
```
